name: AntiVirus
version: $SERVICE_TAG
description: This service facilitates the dispatching and result-parsing to multiple antivirus products.

accepts: .*
rejects: empty|metadata/.*

stage: CORE
category: Antivirus

file_required: true
timeout: 60
disable_cache: false

enabled: false
is_external: false
licence_count: 0

config:
  av_config:
    products:
      - product: "Product1"
        hosts:
          - ip: "localhost"
            port: 1344
            method: "icap"
            update_period: 240  # in minutes
      - product: "Product2"
        hosts:
          - ip: "localhost"
            port: 1344
            version_endpoint: "version"
            scan_endpoint: "scan"
            method: "http"
            update_period: 240  # in minutes
  retry_period: 60  # in seconds
  check_completion_interval: 0  # in milliseconds

heuristics:
  - heur_id: 1
    name: File is infected
    score: 1000
    filetype: '*'
    description: Antivirus hit.

  - heur_id: 2
    name: File is suspicious
    score: 500
    filetype: '*'
    description: Heuristic Analysis hit.

docker_config:
  image: ${REGISTRY}cccs/assemblyline-service-antivirus:$SERVICE_TAG
  cpu_cores: 0.25
  allow_internet_access: true
