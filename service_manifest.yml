name: AntiVirus
version: $SERVICE_TAG
description: This service facilitates the dispatching and result-parsing to multiple anti-virus products.

accepts: .*
rejects: empty|metadata/.*

stage: CORE
category: Antivirus

file_required: true
timeout: 10
disable_cache: false

enabled: false
is_external: false
licence_count: 0

config:
  av_host_details:
    hosts:
      - ip: "localhost"
        port: 1344
        endpoint: "resp"
        method: "icap"
        name: "ICAP_Server"
      - ip: "localhost"
        port: 8080
        endpoint: "req"
        method: "http"
        name: "HTTP_Server"
  retry_period: 60  # in seconds

heuristics:
  - heur_id: 1
    name: File is infected
    score: 1000
    filetype: '*'
    description: Antivirus hit.

  - heur_id: 2
    name: File is suspicious
    score: 500
    filetype: '*'
    description: Heuristic Analysis hit.

docker_config:
  image: ${REGISTRY}cccs/assemblyline-service-antivirus:$SERVICE_TAG
  cpu_cores: 0.25
